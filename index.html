<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ilayang Yuni ES - SF10 Information System</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        const GOOGLE_SHEET_ID = '1utoZUnfPWeGZY2RyGT9cavyMcGl-rr4Dokh22jUwXY8';
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwfHAKsg2ZFjkpe2lrK-mNbamCQT8AJ1G7xzeiTyohG0k86PTan1rPHcNhzH8myLoBFZg/exec';
        
        const App = () => {
            const [isAdmin, setIsAdmin] = useState(false);
            const [students, setStudents] = useState([]);
            const [loading, setLoading] = useState(false);
            const [searchFirst, setSearchFirst] = useState('');
            const [searchMiddle, setSearchMiddle] = useState('');
            const [searchLast, setSearchLast] = useState('');
            const [searchLRN, setSearchLRN] = useState('');
            const [searchMethod, setSearchMethod] = useState('name'); // 'name' or 'lrn'
            const [result, setResult] = useState(null);
            const [showLogin, setShowLogin] = useState(false);
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const [noMiddleName, setNoMiddleName] = useState(false);
            
            // Admin states
            const [adminView, setAdminView] = useState('search'); // 'search', 'add', 'edit', 'list'
            const [searchResult, setSearchResult] = useState(null);
            const [editStudent, setEditStudent] = useState(null);
            const [newStudent, setNewStudent] = useState({
                firstName: '', middleName: '', lastName: '', dateOfBirth: '', lrn: '',
                schoolYear: '2024-2025', status: 'Graduated', sf10IssuedTo: '', sf10DateSent: '', sf10ReferenceNumber: ''
            });

            useEffect(() => { if(isAdmin) loadData(); }, [isAdmin]);

            const loadData = async () => {
                setLoading(true);
                try {
                    const res = await fetch(`${GOOGLE_SCRIPT_URL}?action=getAll`);
                    const data = await res.json();
                    if(data.success) setStudents(data.data || []);
                } catch(e) { console.error(e); }
                setLoading(false);
            };

            const searchPublic = async () => {
                if(searchMethod === 'lrn') {
                    // Search by LRN
                    const lrn = searchLRN.trim();
                    if(!lrn) { 
                        setResult({error: 'Please enter LRN'}); 
                        return; 
                    }
                    setLoading(true);
                    try {
                        const res = await fetch(`${GOOGLE_SCRIPT_URL}?action=search&lrn=${lrn}`);
                        const data = await res.json();
                        
                        if(data.success && data.data.length > 0) {
                            setResult({students: data.data});
                        } else {
                            setResult({error: 'No record found with this LRN'});
                        }
                    } catch(e) { setResult({error: 'Search error'}); }
                    setLoading(false);
                } else {
                    // Search by Name
                    const f = searchFirst.trim().toLowerCase();
                    const l = searchLast.trim().toLowerCase();
                    if(!f && !l) { 
                        setResult({error: 'Please enter at least first name or last name'}); 
                        return; 
                    }
                    setLoading(true);
                    try {
                        const res = await fetch(`${GOOGLE_SCRIPT_URL}?action=search&firstName=${f}&lastName=${l}`);
                        const data = await res.json();
                        
                        if(data.success && data.data.length > 0) {
                            // Check if multiple records
                            if(data.data.length > 1) {
                                setResult({multiple: true, students: data.data});
                            } else {
                                setResult({students: data.data});
                            }
                        } else {
                            setResult({error: 'No record found'});
                        }
                    } catch(e) { setResult({error: 'Search error'}); }
                    setLoading(false);
                }
            };

            const searchWithMiddleName = async () => {
                const f = searchFirst.trim().toLowerCase();
                const l = searchLast.trim().toLowerCase();
                const m = noMiddleName ? '' : searchMiddle.trim().toLowerCase();
                
                setLoading(true);
                try {
                    const res = await fetch(`${GOOGLE_SCRIPT_URL}?action=search&firstName=${f}&middleName=${m}&lastName=${l}`);
                    const data = await res.json();
                    
                    if(data.success && data.data.length > 0) {
                        // Filter based on middle name or no middle name
                        let filtered = data.data;
                        if(noMiddleName) {
                            filtered = data.data.filter(s => !s.middleName || s.middleName.trim() === '' || s.middleName.toUpperCase() === 'N/A');
                        }
                        
                        if(filtered.length > 0) {
                            setResult({students: filtered});
                        } else {
                            setResult({error: 'No matching record found'});
                        }
                    } else {
                        setResult({error: 'No record found'});
                    }
                } catch(e) { setResult({error: 'Search error'}); }
                setLoading(false);
            };

            const searchAdmin = async () => {
                const f = searchFirst.trim().toLowerCase();
                const m = searchMiddle.trim().toLowerCase();
                const l = searchLast.trim().toLowerCase();
                if(!f && !m && !l) { 
                    alert('Please enter at least one name field'); 
                    return; 
                }
                setLoading(true);
                try {
                    const res = await fetch(`${GOOGLE_SCRIPT_URL}?action=search&firstName=${f}&middleName=${m}&lastName=${l}`);
                    const data = await res.json();
                    setSearchResult(data.success && data.data.length > 0 ? {found: true, students: data.data} : {found: false});
                } catch(e) { 
                    alert('Search error'); 
                }
                setLoading(false);
            };

            const add = async () => {
                if(!newStudent.firstName || !newStudent.lastName || !newStudent.dateOfBirth || !newStudent.lrn || !newStudent.schoolYear) {
                    alert('Please fill all required fields'); return;
                }
                setLoading(true);
                try {
                    await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST', mode: 'no-cors',
                        body: JSON.stringify({action: 'add', data: newStudent})
                    });
                    alert('Student record added successfully!');
                    setNewStudent({firstName: '', middleName: '', lastName: '', dateOfBirth: '', lrn: '', schoolYear: '2024-2025', status: 'Graduated', sf10IssuedTo: '', sf10DateSent: '', sf10ReferenceNumber: ''});
                    setSearchFirst('');
                    setSearchMiddle('');
                    setSearchLast('');
                    setSearchResult(null);
                    setAdminView('search');
                    setTimeout(loadData, 2000);
                } catch(e) { alert('Error adding record'); }
                setLoading(false);
            };

            const del = async (id) => {
                if(!confirm('Are you sure you want to delete this record?')) return;
                setLoading(true);
                try {
                    await fetch(GOOGLE_SCRIPT_URL, {method: 'POST', mode: 'no-cors', body: JSON.stringify({action: 'delete', id})});
                    alert('Record deleted successfully!');
                    setTimeout(loadData, 2000);
                } catch(e) { alert('Error deleting record'); }
                setLoading(false);
            };

            const updateStudent = async () => {
                if(!editStudent.firstName || !editStudent.lastName || !editStudent.dateOfBirth || !editStudent.lrn || !editStudent.schoolYear) {
                    alert('Please fill all required fields'); return;
                }
                setLoading(true);
                try {
                    await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST', mode: 'no-cors',
                        body: JSON.stringify({action: 'update', id: editStudent.id, data: editStudent})
                    });
                    alert('Record updated successfully!');
                    setEditStudent(null);
                    setSearchFirst('');
                    setSearchMiddle('');
                    setSearchLast('');
                    setSearchResult(null);
                    setAdminView('search');
                    setTimeout(loadData, 2000);
                } catch(e) { alert('Error updating record'); }
                setLoading(false);
            };

            const statusColor = (s) => ({
                'Graduated': 'bg-green-100 text-green-800',
                'Transferred Out': 'bg-blue-100 text-blue-800',
                'Dropped': 'bg-red-100 text-red-800',
                'Failed': 'bg-orange-100 text-orange-800',
                'Stopped': 'bg-gray-100 text-gray-800'
            }[s] || 'bg-gray-100 text-gray-800');

            const resetAdminSearch = () => {
                setSearchFirst('');
                setSearchMiddle('');
                setSearchLast('');
                setSearchResult(null);
                setAdminView('search');
            };

            const resetPublicSearch = () => {
                setSearchFirst('');
                setSearchMiddle('');
                setSearchLast('');
                setSearchLRN('');
                setNoMiddleName(false);
                setResult(null);
            };

            const startAddNew = () => {
                setNewStudent({
                    firstName: searchFirst.trim(), 
                    middleName: searchMiddle.trim(), 
                    lastName: searchLast.trim(), 
                    dateOfBirth: '', 
                    lrn: '',
                    schoolYear: '2024-2025', 
                    status: 'Graduated', 
                    sf10IssuedTo: '', 
                    sf10DateSent: '', 
                    sf10ReferenceNumber: ''
                });
                setAdminView('add');
            };

            const startUpdate = (student) => {
                setEditStudent({...student});
                setAdminView('edit');
            };

            if(!isAdmin) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-green-50 p-4">
                        {loading && <div className="fixed top-4 right-4 bg-blue-600 text-white px-4 py-2 rounded shadow z-50">Loading...</div>}
                        <div className="max-w-4xl mx-auto">
                            <div className="text-center mb-8">
                                <img src="logo.png" className="w-32 h-32 mx-auto mb-4" onError={(e) => e.target.style.display='none'} />
                                <h1 className="text-4xl font-bold text-gray-800 mb-2">Ilayang Yuni ES</h1>
                                <h2 className="text-2xl font-semibold text-blue-600 mb-1">SF10 Information System</h2>
                                <p className="text-gray-600 font-semibold">Sa Ilayang Yuni, Lahat RESPONSABLE</p>
                            </div>
                            <div className="bg-white rounded-xl shadow-lg p-8 mb-6">
                                <h3 className="text-2xl font-semibold mb-6 text-center">Search SF10 Record</h3>
                                
                                {/* Search Method Radio Buttons */}
                                <div className="mb-6">
                                    <label className="block mb-3 font-medium text-gray-700">Search Method:</label>
                                    <div className="flex gap-6">
                                        <label className="flex items-center cursor-pointer">
                                            <input 
                                                type="radio" 
                                                name="searchMethod" 
                                                value="name"
                                                checked={searchMethod === 'name'}
                                                onChange={(e) => setSearchMethod(e.target.value)}
                                                className="w-4 h-4 mr-2"
                                            />
                                            <span className="text-gray-700">Search by Name</span>
                                        </label>
                                        <label className="flex items-center cursor-pointer">
                                            <input 
                                                type="radio" 
                                                name="searchMethod" 
                                                value="lrn"
                                                checked={searchMethod === 'lrn'}
                                                onChange={(e) => setSearchMethod(e.target.value)}
                                                className="w-4 h-4 mr-2"
                                            />
                                            <span className="text-gray-700">Search by LRN</span>
                                        </label>
                                    </div>
                                </div>

                                {/* Conditional Fields */}
                                {searchMethod === 'name' ? (
                                    <>
                                        <input 
                                            type="text" 
                                            value={searchFirst} 
                                            onChange={(e) => setSearchFirst(e.target.value)} 
                                            placeholder="First Name" 
                                            className="w-full p-3 border-2 rounded mb-3 focus:border-blue-500 outline-none" 
                                            onKeyPress={(e) => e.key === 'Enter' && searchPublic()} 
                                        />
                                        <input 
                                            type="text" 
                                            value={searchLast} 
                                            onChange={(e) => setSearchLast(e.target.value)} 
                                            placeholder="Last Name" 
                                            className="w-full p-3 border-2 rounded mb-3 focus:border-blue-500 outline-none" 
                                            onKeyPress={(e) => e.key === 'Enter' && searchPublic()} 
                                        />
                                    </>
                                ) : (
                                    <input 
                                        type="text" 
                                        value={searchLRN} 
                                        onChange={(e) => setSearchLRN(e.target.value)} 
                                        placeholder="Enter LRN (12 digits)" 
                                        className="w-full p-3 border-2 rounded mb-3 focus:border-blue-500 outline-none" 
                                        maxLength="12"
                                        onKeyPress={(e) => e.key === 'Enter' && searchPublic()} 
                                    />
                                )}
                                
                                <button onClick={searchPublic} className="w-full bg-blue-600 text-white p-3 rounded font-semibold hover:bg-blue-700 transition">
                                    üîç Search
                                </button>
                            </div>
                            
                            {/* MULTIPLE RECORDS FOUND - ASK FOR MIDDLE NAME */}
                            {result && result.multiple && (
                                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" onClick={() => setResult(null)}>
                                    <div className="bg-white rounded-xl max-w-lg w-full p-8" onClick={(e) => e.stopPropagation()}>
                                        <div className="text-center mb-6">
                                            <div className="inline-block bg-yellow-100 text-yellow-800 px-6 py-3 rounded-lg mb-4">
                                                <h3 className="text-2xl font-bold">‚ö† Multiple Records Found</h3>
                                            </div>
                                            <p className="text-gray-700 mb-2">We found <strong>{result.students.length} students</strong> with the name:</p>
                                            <p className="text-xl font-bold text-blue-600 mb-4">{searchFirst} {searchLast}</p>
                                            <p className="text-gray-600">Please enter your middle name to identify the correct record.</p>
                                        </div>
                                        
                                        <div className="space-y-4">
                                            <div>
                                                <label className="block mb-2 font-medium">Middle Name</label>
                                                <input 
                                                    type="text" 
                                                    value={searchMiddle} 
                                                    onChange={(e) => {
                                                        setSearchMiddle(e.target.value);
                                                        if(e.target.value) setNoMiddleName(false);
                                                    }}
                                                    placeholder="Enter your middle name" 
                                                    className="w-full p-3 border-2 rounded focus:border-blue-500 outline-none"
                                                    disabled={noMiddleName}
                                                    onKeyPress={(e) => e.key === 'Enter' && !noMiddleName && searchWithMiddleName()}
                                                />
                                            </div>
                                            
                                            <div className="flex items-center">
                                                <input 
                                                    type="checkbox" 
                                                    id="noMiddleName" 
                                                    checked={noMiddleName}
                                                    onChange={(e) => {
                                                        setNoMiddleName(e.target.checked);
                                                        if(e.target.checked) setSearchMiddle('');
                                                    }}
                                                    className="w-4 h-4 mr-2"
                                                />
                                                <label htmlFor="noMiddleName" className="text-gray-700 cursor-pointer">
                                                    I don't have a middle name
                                                </label>
                                            </div>
                                            
                                            <button 
                                                onClick={searchWithMiddleName} 
                                                className="w-full bg-blue-600 text-white p-3 rounded font-semibold hover:bg-blue-700 transition">
                                                Search Again
                                            </button>
                                            <button 
                                                onClick={() => setResult(null)} 
                                                className="w-full bg-gray-300 text-gray-800 p-3 rounded font-semibold hover:bg-gray-400 transition">
                                                Cancel
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            )}
                            
                            {/* SINGLE RECORD OR ERROR */}
                            {result && !result.multiple && (
                                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" onClick={resetPublicSearch}>
                                    <div className="bg-white rounded-xl max-w-5xl w-full max-h-[95vh] overflow-y-auto" onClick={(e) => e.stopPropagation()}>
                                        {result.error ? (
                                            <div className="p-8 text-center">
                                                <h3 className="text-2xl font-bold mb-4 text-red-600">No Record Found</h3>
                                                <p className="mb-4 text-gray-700">{result.error}</p>
                                                <button onClick={resetPublicSearch} className="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition">Close</button>
                                            </div>
                                        ) : (
                                            result.students.map((s, i) => (
                                                <div key={i} className="p-8">
                                                    <div className="text-center mb-6 pb-4 border-b">
                                                        <h2 className="text-2xl font-bold text-blue-600">ILAYANG YUNI ELEMENTARY SCHOOL</h2>
                                                        <p className="text-gray-600 font-semibold">Sa Ilayang Yuni, Lahat RESPONSABLE</p>
                                                        <div className="mt-3 inline-block bg-blue-600 text-white px-4 py-1 rounded-full">SF10 RECORD FOUND</div>
                                                    </div>
                                                    <div className="grid grid-cols-2 gap-4 mb-6">
                                                        <div className="bg-blue-50 p-4 rounded">
                                                            <strong className="text-sm text-gray-600">First Name:</strong>
                                                            <div className="text-2xl font-bold mt-1">{s.firstName}</div>
                                                        </div>
                                                        <div className="bg-blue-50 p-4 rounded">
                                                            <strong className="text-sm text-gray-600">Middle Name:</strong>
                                                            <div className="text-2xl font-bold mt-1">{s.middleName || 'N/A'}</div>
                                                        </div>
                                                        <div className="bg-blue-50 p-4 rounded">
                                                            <strong className="text-sm text-gray-600">Last Name:</strong>
                                                            <div className="text-2xl font-bold mt-1">{s.lastName}</div>
                                                        </div>
                                                        <div className="bg-purple-50 p-4 rounded">
                                                            <strong className="text-sm text-gray-600">Date of Birth:</strong>
                                                            <div className="text-xl font-bold mt-1">{new Date(s.dateOfBirth).toLocaleDateString('en-US', {year: 'numeric', month: 'long', day: 'numeric'})}</div>
                                                        </div>
                                                        <div className="bg-yellow-50 p-4 rounded">
                                                            <strong className="text-sm text-gray-600">LRN:</strong>
                                                            <div className="text-xl font-bold mt-1">{s.lrn}</div>
                                                        </div>
                                                        <div className="bg-blue-50 p-4 rounded">
                                                            <strong className="text-sm text-gray-600">School Year Last Attended:</strong>
                                                            <div className="text-2xl font-bold mt-1">{s.schoolYear}</div>
                                                        </div>
                                                        <div className="bg-green-50 p-4 rounded col-span-2">
                                                            <strong className="text-sm text-gray-600">Status:</strong>
                                                            <div className="mt-2">
                                                                <span className={`px-4 py-2 rounded ${statusColor(s.status)} font-bold text-lg`}>{s.status}</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    {(s.sf10IssuedTo || s.sf10DateSent || s.sf10ReferenceNumber) && (
                                                        <div className="bg-indigo-50 p-5 rounded mb-6">
                                                            <h4 className="font-bold mb-3 text-lg">SF10 Transfer Information</h4>
                                                            <div className="grid grid-cols-3 gap-4">
                                                                {s.sf10IssuedTo && (
                                                                    <div>
                                                                        <strong className="text-sm text-gray-600">Issued To:</strong>
                                                                        <div className="font-semibold mt-1">{s.sf10IssuedTo}</div>
                                                                    </div>
                                                                )}
                                                                {s.sf10DateSent && (
                                                                    <div>
                                                                        <strong className="text-sm text-gray-600">Date Sent:</strong>
                                                                        <div className="font-semibold mt-1">{new Date(s.sf10DateSent).toLocaleDateString('en-US', {year: 'numeric', month: 'long', day: 'numeric'})}</div>
                                                                    </div>
                                                                )}
                                                                {s.sf10ReferenceNumber && (
                                                                    <div>
                                                                        <strong className="text-sm text-gray-600">Reference #:</strong>
                                                                        <div className="font-semibold mt-1">{s.sf10ReferenceNumber}</div>
                                                                    </div>
                                                                )}
                                                            </div>
                                                        </div>
                                                    )}
                                                    <button onClick={resetPublicSearch} className="w-full bg-blue-600 text-white p-3 rounded-lg font-semibold hover:bg-blue-700 transition">Close</button>
                                                </div>
                                            ))
                                        )}
                                    </div>
                                </div>
                            )}
                            
                            <div className="text-center"><button onClick={() => setShowLogin(true)} className="text-gray-500 text-sm hover:text-gray-700">Administrator Access</button></div>
                            {showLogin && (
                                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                                    <div className="bg-white rounded-lg p-6 max-w-md w-full">
                                        <h3 className="text-xl font-bold mb-4">Admin Login</h3>
                                        <input type="password" value={password} onChange={(e) => setPassword(e.target.value)} placeholder="Password" className="w-full p-2 border-2 rounded mb-2 focus:border-blue-500 outline-none" onKeyPress={(e) => e.key === 'Enter' && (password === 'IlayangYuni2025' ? (setIsAdmin(true), setShowLogin(false), setPassword('')) : setError('Wrong password'))} />
                                        {error && <p className="text-red-600 text-sm mb-2">{error}</p>}
                                        <div className="flex gap-2">
                                            <button onClick={() => password === 'IlayangYuni2025' ? (setIsAdmin(true), setShowLogin(false), setPassword('')) : setError('Wrong password')} className="flex-1 bg-blue-600 text-white p-2 rounded hover:bg-blue-700 transition">Login</button>
                                            <button onClick={() => (setShowLogin(false), setPassword(''), setError(''))} className="flex-1 bg-gray-300 p-2 rounded hover:bg-gray-400 transition">Cancel</button>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                );
            }

            // ADMIN PANEL
            return (
                <div className="min-h-screen bg-gray-100 p-4">
                    {loading && <div className="fixed top-4 left-4 bg-blue-600 text-white px-4 py-2 rounded shadow z-50">Processing...</div>}
                    <div className="max-w-6xl mx-auto">
                        {/* Header */}
                        <div className="bg-blue-600 text-white rounded-lg p-6 mb-6 flex justify-between items-center">
                            <div>
                                <h1 className="text-2xl font-bold">SF10 Information System - Admin</h1>
                                <p>Ilayang Yuni Elementary School</p>
                            </div>
                            <button onClick={() => setIsAdmin(false)} className="bg-white text-blue-600 px-4 py-2 rounded font-semibold hover:bg-gray-100 transition">Logout</button>
                        </div>

                        {/* Statistics */}
                        <div className="grid grid-cols-3 gap-4 mb-6">
                            <div className="bg-white p-6 rounded shadow"><p className="text-gray-600">Total Records</p><p className="text-3xl font-bold">{students.length}</p></div>
                            <div className="bg-white p-6 rounded shadow"><p className="text-gray-600">Graduated</p><p className="text-3xl font-bold text-green-600">{students.filter(s => s.status === 'Graduated').length}</p></div>
                            <div className="bg-white p-6 rounded shadow"><p className="text-gray-600">School Years</p><p className="text-3xl font-bold text-purple-600">{new Set(students.map(s => s.schoolYear)).size}</p></div>
                        </div>

                        {/* Navigation Buttons */}
                        <div className="mb-6 flex gap-2">
                            <button 
                                onClick={resetAdminSearch} 
                                className={`px-6 py-3 rounded font-semibold transition ${adminView === 'search' ? 'bg-blue-600 text-white' : 'bg-white text-blue-600 hover:bg-blue-50'}`}>
                                üîç Search Student
                            </button>
                            <button 
                                onClick={() => setAdminView('list')} 
                                className={`px-6 py-3 rounded font-semibold transition ${adminView === 'list' ? 'bg-blue-600 text-white' : 'bg-white text-blue-600 hover:bg-blue-50'}`}>
                                üìã View All Records
                            </button>
                            <button onClick={loadData} className="bg-green-600 text-white px-6 py-3 rounded font-semibold ml-auto hover:bg-green-700 transition">‚Üª Refresh Data</button>
                        </div>

                        {/* SEARCH VIEW */}
                        {adminView === 'search' && !searchResult && (
                            <div className="bg-white rounded-lg shadow p-8">
                                <div className="max-w-2xl mx-auto">
                                    <h2 className="text-2xl font-bold mb-2 text-center">Search for Student Record</h2>
                                    <p className="text-gray-600 text-center mb-6">Search by name to check if student already exists before adding</p>
                                    
                                    <div className="space-y-4">
                                        <div>
                                            <label className="block mb-1 font-medium text-sm">First Name</label>
                                            <input 
                                                type="text" 
                                                value={searchFirst} 
                                                onChange={(e) => setSearchFirst(e.target.value)} 
                                                placeholder="Enter first name" 
                                                className="w-full p-3 border-2 rounded focus:border-blue-500 outline-none"
                                                onKeyPress={(e) => e.key === 'Enter' && searchAdmin()}
                                            />
                                        </div>
                                        <div>
                                            <label className="block mb-1 font-medium text-sm">Middle Name</label>
                                            <input 
                                                type="text" 
                                                value={searchMiddle} 
                                                onChange={(e) => setSearchMiddle(e.target.value)} 
                                                placeholder="Enter middle name (optional)" 
                                                className="w-full p-3 border-2 rounded focus:border-blue-500 outline-none"
                                                onKeyPress={(e) => e.key === 'Enter' && searchAdmin()}
                                            />
                                        </div>
                                        <div>
                                            <label className="block mb-1 font-medium text-sm">Last Name</label>
                                            <input 
                                                type="text" 
                                                value={searchLast} 
                                                onChange={(e) => setSearchLast(e.target.value)} 
                                                placeholder="Enter last name" 
                                                className="w-full p-3 border-2 rounded focus:border-blue-500 outline-none"
                                                onKeyPress={(e) => e.key === 'Enter' && searchAdmin()}
                                            />
                                        </div>
                                        <button 
                                            onClick={searchAdmin} 
                                            className="w-full bg-blue-600 text-white p-4 rounded-lg font-semibold text-lg hover:bg-blue-700 transition">
                                            üîç Search Student
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* SEARCH RESULTS - RECORD FOUND */}
                        {adminView === 'search' && searchResult && searchResult.found && (
                            <div className="bg-white rounded-lg shadow p-8">
                                <div className="text-center mb-6">
                                    <div className="inline-block bg-green-100 text-green-800 px-6 py-3 rounded-lg mb-4">
                                        <h3 className="text-2xl font-bold">‚úì Record Found</h3>
                                    </div>
                                    <p className="text-gray-600">Student record(s) already exist in the system</p>
                                </div>

                                {searchResult.students.map((student, index) => (
                                    <div key={index} className="bg-gray-50 rounded-lg p-6 mb-4 border-2 border-gray-200">
                                        <div className="grid grid-cols-2 gap-4 mb-4">
                                            <div><strong>Full Name:</strong> {student.firstName} {student.middleName} {student.lastName}</div>
                                            <div><strong>LRN:</strong> {student.lrn}</div>
                                            <div><strong>Date of Birth:</strong> {new Date(student.dateOfBirth).toLocaleDateString('en-US', {year: 'numeric', month: 'long', day: 'numeric'})}</div>
                                            <div><strong>School Year Last Attended:</strong> {student.schoolYear}</div>
                                            <div><strong>Status:</strong> <span className={`px-3 py-1 rounded ${statusColor(student.status)}`}>{student.status}</span></div>
                                            {student.sf10IssuedTo && <div><strong>SF10 Issued To:</strong> {student.sf10IssuedTo}</div>}
                                        </div>
                                        <button 
                                            onClick={() => startUpdate(student)} 
                                            className="w-full bg-blue-600 text-white p-3 rounded font-semibold hover:bg-blue-700 transition">
                                            üìù Update This Record
                                        </button>
                                    </div>
                                ))}

                                <button 
                                    onClick={resetAdminSearch} 
                                    className="w-full bg-gray-300 text-gray-800 p-3 rounded font-semibold hover:bg-gray-400 transition">
                                    ‚Üê Back to Search
                                </button>
                            </div>
                        )}

                        {/* SEARCH RESULTS - NO RECORD FOUND */}
                        {adminView === 'search' && searchResult && !searchResult.found && (
                            <div className="bg-white rounded-lg shadow p-8">
                                <div className="text-center mb-6">
                                    <div className="inline-block bg-yellow-100 text-yellow-800 px-6 py-3 rounded-lg mb-4">
                                        <h3 className="text-2xl font-bold">‚ö† No Record Found</h3>
                                    </div>
                                    <p className="text-gray-600 mb-2">No existing record found for:</p>
                                    <p className="font-semibold text-lg">{searchFirst} {searchMiddle} {searchLast}</p>
                                </div>

                                <div className="max-w-md mx-auto space-y-3">
                                    <button 
                                        onClick={startAddNew} 
                                        className="w-full bg-green-600 text-white p-4 rounded-lg font-semibold text-lg hover:bg-green-700 transition">
                                        ‚ûï Add New Record
                                    </button>
                                    <button 
                                        onClick={resetAdminSearch} 
                                        className="w-full bg-gray-300 text-gray-800 p-3 rounded font-semibold hover:bg-gray-400 transition">
                                        ‚Üê Search Again
                                    </button>
                                </div>
                            </div>
                        )}

                        {/* ADD NEW STUDENT FORM */}
                        {adminView === 'add' && (
                            <div className="bg-white rounded-lg p-6 shadow">
                                <h3 className="text-2xl font-bold mb-6 text-center">‚ûï Add New Student Record</h3>
                                <div className="grid grid-cols-2 gap-4 mb-4">
                                    <div><label className="block mb-1 text-sm font-medium">First Name *</label><input type="text" value={newStudent.firstName} onChange={(e) => setNewStudent({...newStudent, firstName: e.target.value})} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" /></div>
                                    <div><label className="block mb-1 text-sm font-medium">Middle Name (or N/A if none)</label><input type="text" value={newStudent.middleName} onChange={(e) => setNewStudent({...newStudent, middleName: e.target.value})} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" placeholder="N/A" /></div>
                                    <div><label className="block mb-1 text-sm font-medium">Last Name *</label><input type="text" value={newStudent.lastName} onChange={(e) => setNewStudent({...newStudent, lastName: e.target.value})} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" /></div>
                                    <div><label className="block mb-1 text-sm font-medium">Date of Birth *</label><input type="date" value={newStudent.dateOfBirth} onChange={(e) => setNewStudent({...newStudent, dateOfBirth: e.target.value})} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" /></div>
                                    <div><label className="block mb-1 text-sm font-medium">LRN * (or N/A if none)</label><input type="text" value={newStudent.lrn} onChange={(e) => setNewStudent({...newStudent, lrn: e.target.value})} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" maxLength="12" placeholder="N/A" /></div>
                                    <div><label className="block mb-1 text-sm font-medium">School Year Last Attended *</label><select value={newStudent.schoolYear} onChange={(e) => setNewStudent({...newStudent, schoolYear: e.target.value})} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none"><option>2024-2025</option><option>2025-2026</option><option>2026-2027</option><option>2023-2024</option><option>2022-2023</option></select></div>
                                    <div><label className="block mb-1 text-sm font-medium">Status *</label><select value={newStudent.status} onChange={(e) => setNewStudent({...newStudent, status: e.target.value})} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none"><option>Graduated</option><option>Transferred Out</option><option>Dropped</option><option>Failed</option><option>Stopped</option></select></div>
                                </div>
                                <div className="bg-indigo-50 p-4 rounded mb-4">
                                    <h4 className="font-semibold mb-2">SF10 Transfer Info (Optional)</h4>
                                    <div className="grid grid-cols-3 gap-3">
                                        <div><label className="block mb-1 text-sm">Issued To</label><input type="text" value={newStudent.sf10IssuedTo} onChange={(e) => setNewStudent({...newStudent, sf10IssuedTo: e.target.value})} className="w-full p-2 border rounded focus:border-blue-500 outline-none" placeholder="School/Institution" /></div>
                                        <div><label className="block mb-1 text-sm">Date Sent</label><input type="date" value={newStudent.sf10DateSent} onChange={(e) => setNewStudent({...newStudent, sf10DateSent: e.target.value})} className="w-full p-2 border rounded focus:border-blue-500 outline-none" /></div>
                                        <div><label className="block mb-1 text-sm">Reference #</label><input type="text" value={newStudent.sf10ReferenceNumber} onChange={(e) => setNewStudent({...newStudent, sf10ReferenceNumber: e.target.value})} className="w-full p-2 border rounded focus:border-blue-500 outline-none" placeholder="e.g. REF-2025-001" /></div>
                                    </div>
                                </div>
                                <div className="flex gap-2">
                                    <button onClick={add} className="flex-1 bg-green-600 text-white px-6 py-3 rounded font-semibold hover:bg-green-700 transition">‚úì Save New Record</button>
                                    <button onClick={resetAdminSearch} className="flex-1 bg-gray-300 px-6 py-3 rounded font-semibold hover:bg-gray-400 transition">Cancel</button>
                                </div>
                            </div>
                        )}

                        {/* EDIT STUDENT FORM */}
                        {adminView === 'edit' && editStudent && (
                            <div className="bg-white rounded-lg p-6 shadow">
                                <h3 className="text-2xl font-bold mb-6 text-center">üìù Update Student Record</h3>
                                <div className="bg-blue-50 p-4 rounded mb-6">
                                    <h4 className="font-semibold mb-2">Student Information</h4>
                                    <p><strong>Name:</strong> {editStudent.firstName} {editStudent.middleName} {editStudent.lastName}</p>
                                    <p><strong>LRN:</strong> {editStudent.lrn}</p>
                                </div>
                                <div className="grid grid-cols-2 gap-4 mb-4">
                                    <div><label className="block mb-1 text-sm font-medium">First Name *</label><input type="text" value={editStudent.firstName} onChange={(e) => setEditStudent({...editStudent, firstName: e.target.value})} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" /></div>
                                    <div><label className="block mb-1 text-sm font-medium">Middle Name (or N/A if none)</label><input type="text" value={editStudent.middleName || ''} onChange={(e) => setEditStudent({...editStudent, middleName: e.target.value})} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" placeholder="N/A" /></div>
                                    <div><label className="block mb-1 text-sm font-medium">Last Name *</label><input type="text" value={editStudent.lastName} onChange={(e) => setEditStudent({...editStudent, lastName: e.target.value})} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" /></div>
                                    <div><label className="block mb-1 text-sm font-medium">Date of Birth *</label><input type="date" value={editStudent.dateOfBirth} onChange={(e) => setEditStudent({...editStudent, dateOfBirth: e.target.value})} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" /></div>
                                    <div><label className="block mb-1 text-sm font-medium">LRN * (or N/A if none)</label><input type="text" value={editStudent.lrn} onChange={(e) => setEditStudent({...editStudent, lrn: e.target.value})} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" maxLength="12" placeholder="N/A" /></div>
                                    <div><label className="block mb-1 text-sm font-medium">School Year Last Attended *</label><select value={editStudent.schoolYear} onChange={(e) => setEditStudent({...editStudent, schoolYear: e.target.value})} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none"><option>2024-2025</option><option>2025-2026</option><option>2026-2027</option><option>2023-2024</option><option>2022-2023</option></select></div>
                                    <div><label className="block mb-1 text-sm font-medium">Status *</label><select value={editStudent.status} onChange={(e) => setEditStudent({...editStudent, status: e.target.value})} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none"><option>Graduated</option><option>Transferred Out</option><option>Dropped</option><option>Failed</option><option>Stopped</option></select></div>
                                </div>
                                <div className="bg-indigo-50 p-4 rounded mb-4">
                                    <h4 className="font-semibold mb-2">SF10 Transfer Info (Optional)</h4>
                                    <div className="grid grid-cols-3 gap-3">
                                        <div><label className="block mb-1 text-sm">Issued To</label><input type="text" value={editStudent.sf10IssuedTo || ''} onChange={(e) => setEditStudent({...editStudent, sf10IssuedTo: e.target.value})} className="w-full p-2 border rounded focus:border-blue-500 outline-none" placeholder="School/Institution" /></div>
                                        <div><label className="block mb-1 text-sm">Date Sent</label><input type="date" value={editStudent.sf10DateSent || ''} onChange={(e) => setEditStudent({...editStudent, sf10DateSent: e.target.value})} className="w-full p-2 border rounded focus:border-blue-500 outline-none" /></div>
                                        <div><label className="block mb-1 text-sm">Reference #</label><input type="text" value={editStudent.sf10ReferenceNumber || ''} onChange={(e) => setEditStudent({...editStudent, sf10ReferenceNumber: e.target.value})} className="w-full p-2 border rounded focus:border-blue-500 outline-none" placeholder="e.g. REF-2025-001" /></div>
                                    </div>
                                </div>
                                <div className="flex gap-2">
                                    <button onClick={updateStudent} className="flex-1 bg-blue-600 text-white px-6 py-3 rounded font-semibold hover:bg-blue-700 transition">‚úì Update Record</button>
                                    <button onClick={resetAdminSearch} className="flex-1 bg-gray-300 px-6 py-3 rounded font-semibold hover:bg-gray-400 transition">Cancel</button>
                                </div>
                            </div>
                        )}

                        {/* VIEW ALL RECORDS TABLE */}
                        {adminView === 'list' && (
                            <div className="bg-white rounded-lg shadow overflow-auto">
                                <div className="p-4 bg-gray-50 border-b">
                                    <h3 className="text-xl font-bold">All Student Records</h3>
                                </div>
                                <table className="w-full">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="p-3 text-left text-xs font-semibold">Name</th>
                                            <th className="p-3 text-left text-xs font-semibold">LRN</th>
                                            <th className="p-3 text-left text-xs font-semibold">School Year Last Attended</th>
                                            <th className="p-3 text-left text-xs font-semibold">Status</th>
                                            <th className="p-3 text-left text-xs font-semibold">SF10 Location</th>
                                            <th className="p-3 text-left text-xs font-semibold">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {students.length === 0 ? (
                                            <tr><td colSpan="6" className="p-8 text-center text-gray-500">{loading ? 'Loading...' : 'No records found. Search and add students to get started.'}</td></tr>
                                        ) : (
                                            students.map(s => (
                                                <tr key={s.id} className="border-t hover:bg-gray-50">
                                                    <td className="p-3 text-sm">{s.firstName} {s.middleName} {s.lastName}</td>
                                                    <td className="p-3 text-sm">{s.lrn}</td>
                                                    <td className="p-3 text-sm">{s.schoolYear}</td>
                                                    <td className="p-3"><span className={`px-2 py-1 rounded text-xs ${statusColor(s.status)}`}>{s.status}</span></td>
                                                    <td className="p-3 text-sm">{s.sf10IssuedTo || <span className="text-gray-400">Not forwarded</span>}</td>
                                                    <td className="p-3">
                                                        <button onClick={() => startUpdate(s)} className="text-blue-600 text-sm mr-3 hover:underline">Edit</button>
                                                        <button onClick={() => del(s.id)} className="text-red-600 text-sm hover:underline">Delete</button>
                                                    </td>
                                                </tr>
                                            ))
                                        )}
                                    </tbody>
                                </table>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
