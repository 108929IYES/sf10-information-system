<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SF10 Information System - Ilayang Yuni Elementary School</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap');
        body { font-family: 'Poppins', sans-serif; }
        .developer-credit {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            text-align: center;
            padding: 12px;
            font-size: 14px;
            font-weight: 500;
            z-index: 40;
            box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .pdf-preview-container {
            width: 100%;
            height: 600px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            // Replace with your actual Google Apps Script URL
            const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxlGaAj_tRuqhVG4SjUbLS97-iJVTXVjB-OHn0lNHja_NdPzW8QmrR0variIQMFwqSFRw/exec';

            // State management
            const [loading, setLoading] = useState(false);
            const [students, setStudents] = useState([]);
            const [searchFirst, setSearchFirst] = useState('');
            const [searchMiddle, setSearchMiddle] = useState('');
            const [searchLast, setSearchLast] = useState('');
            const [searchLRN, setSearchLRN] = useState('');
            const [searchMethod, setSearchMethod] = useState('name');
            const [result, setResult] = useState(null);
            const [showLogin, setShowLogin] = useState(false);
            const [showForgotPassword, setShowForgotPassword] = useState(false);
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const [noMiddleName, setNoMiddleName] = useState(false);
            const [isAdmin, setIsAdmin] = useState(false);
            const [uploadProgress, setUploadProgress] = useState('');
            const [pdfPreview, setPdfPreview] = useState(null);
            const [showPdfModal, setShowPdfModal] = useState(false);
            const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);
            const [studentToDelete, setStudentToDelete] = useState(null);

            // Admin states
            const [adminView, setAdminView] = useState('search');
            const [adminSearchFirst, setAdminSearchFirst] = useState('');
            const [adminSearchMiddle, setAdminSearchMiddle] = useState('');
            const [adminSearchLast, setAdminSearchLast] = useState('');
            const [adminSearchLRN, setAdminSearchLRN] = useState('');
            const [adminSearchResults, setAdminSearchResults] = useState([]);
            const [newStudent, setNewStudent] = useState({
                firstName: '', middleName: '', lastName: '', dateOfBirth: '', lrn: '',
    		schoolYear: '2024-2025', gradeLastAttended: '', status: 'Graduated',
    		sf10ReleasedTo: '', sf10ReleaseDate: '', sf10CopyReleased: '',
    		sf10TrackingNumber: '', sf10ReceivedBy: '', sf10ReceivedByDate: '',
    		sf10CopyReceived: '', sf10DateReceived: '', sf10ReceivedFrom: '',
    		sf10EndorsedTo: '', sf10DateEndorsed: '', sf10DocumentUrl: ''
            });
            const [editStudent, setEditStudent] = useState(null);
            const [uploadedFile, setUploadedFile] = useState(null);

            useEffect(() => {
                if (isAdmin) loadData();
            }, [isAdmin]);

            const statusColor = (status) => {
                const colors = {
                    'Graduated': 'bg-green-100 text-green-800',
                    'Transferred Out': 'bg-blue-100 text-blue-800',
                    'Dropped': 'bg-red-100 text-red-800',
                    'Failed': 'bg-orange-100 text-orange-800',
                    'Stopped': 'bg-gray-100 text-gray-800'
                };
                return colors[status] || 'bg-gray-100 text-gray-800';
            };

            const loadData = async () => {
                setLoading(true);
                try {
                    const res = await fetch(`${GOOGLE_SCRIPT_URL}?action=getAll`);
                    const data = await res.json();
                    setStudents(data.success ? data.data : []);
                } catch (e) {
                    console.error('Load error:', e);
                }
                setLoading(false);
        };

        // Get SF10 availability status for public view
        const getSF10Status = (student) => {
                if (!student.sf10CopyReleased) {
                    return { 
                        icon: '‚úÖ', 
                        color: 'bg-green-50 border-2 border-green-200', 
                        message: 'SF10 ORIGINAL COPY is available at the school.', 
                        sub: 'Please proceed to the Principal\'s Office to request your document.' 
                    };
                }
                
                if (student.sf10CopyReleased === 'Original') {
                    return { 
                        icon: '‚ö†Ô∏è', 
                        color: 'bg-yellow-50 border-2 border-yellow-200', 
                        message: 'Only AUTHENTICATED COPY is available at the school.', 
                        sub: 'The original copy has been released. Please proceed to the Principal\'s Office to request an authenticated copy.' 
                    };
                }
                
                if (student.sf10CopyReleased === 'Authenticated') {
                    return { 
                        icon: '‚ùå', 
                        color: 'bg-red-50 border-2 border-red-200', 
                        message: 'SF10 copies have been released.', 
                        sub: 'Please contact the Principal\'s Office for assistance.' 
                    };
                }
                
                return { 
                    icon: '‚ÑπÔ∏è', 
                    color: 'bg-blue-50 border-2 border-blue-200', 
                    message: 'SF10 document is being processed.', 
                    sub: 'Please contact the Principal\'s Office for more information.' 
                };
            };

            const searchPublic = async () => {
                if (searchMethod === 'lrn') {
                    const lrn = searchLRN.trim();
                    if (!lrn) {
                        setResult({ error: 'Please enter LRN' });
                        return;
                    }
                    setLoading(true);
                    try {
                        const res = await fetch(`${GOOGLE_SCRIPT_URL}?action=search&lrn=${lrn}`);
                        const data = await res.json();
                        if (data.success && data.data.length > 0) {
                            setResult({ students: data.data });
                        } else {
                            setResult({ error: 'No record found with this LRN' });
                        }
                    } catch (e) {
                        setResult({ error: 'Search error' });
                    }
                    setLoading(false);
                } else {
                    const f = searchFirst.trim().toLowerCase();
                    const l = searchLast.trim().toLowerCase();
                    if (!f && !l) {
                        setResult({ error: 'Please enter at least first name or last name' });
                        return;
                    }
                    setLoading(true);
                    try {
                        const res = await fetch(`${GOOGLE_SCRIPT_URL}?action=search&firstName=${f}&lastName=${l}`);
                        const data = await res.json();
                        if (data.success && data.data.length > 0) {
                            if (data.data.length > 1) {
                                setResult({ multiple: true, students: data.data });
                            } else {
                                setResult({ students: data.data });
                            }
                        } else {
                            setResult({ error: 'No record found' });
                        }
                    } catch (e) {
                        setResult({ error: 'Search error' });
                    }
                    setLoading(false);
                }
            };

            const searchWithMiddleName = async () => {
                const f = searchFirst.trim().toLowerCase();
                const l = searchLast.trim().toLowerCase();
                if (!f && !l) {
                    setResult({ error: 'Enter name' });
                    return;
                }
                const m = noMiddleName ? '' : searchMiddle.trim().toLowerCase();

                setLoading(true);
                try {
                    const res = await fetch(`${GOOGLE_SCRIPT_URL}?action=search&firstName=${f}&middleName=${m}&lastName=${l}`);
                    const data = await res.json();

                    if (data.success && data.data.length > 0) {
                        let filtered = data.data;
                        if (noMiddleName) {
                            filtered = data.data.filter(s => !s.middleName || s.middleName.trim() === '' || s.middleName.toUpperCase() === 'N/A');
                        }

                        if (filtered.length > 0) {
                            setResult({ students: filtered });
                        } else {
                            setResult({ error: 'No matching record found' });
                        }
                    } else {
                        setResult({ error: 'No record found' });
                    }
                } catch (e) {
                    setResult({ error: 'Search error' });
                }
                setLoading(false);
            };

            const searchAdmin = async () => {
                const f = adminSearchFirst.trim().toLowerCase();
                const m = adminSearchMiddle.trim().toLowerCase();
                const l = adminSearchLast.trim().toLowerCase();
                const lrn = adminSearchLRN.trim();

                if (!f && !m && !l && !lrn) {
                    alert('Please enter at least one search field');
                    return;
                }

                setLoading(true);
                try {
                    const res = await fetch(`${GOOGLE_SCRIPT_URL}?action=search&firstName=${f}&middleName=${m}&lastName=${l}&lrn=${lrn}`);
                    const data = await res.json();
                    setAdminSearchResults(data.success ? data.data : []);
                } catch (e) {
                    setAdminSearchResults([]);
                }
                setLoading(false);
            };

            const handleFileSelect = (e) => {
                const file = e.target.files[0];
                if (file && file.type === 'application/pdf') {
                    setUploadedFile(file);
                    setUploadProgress('File selected: ' + file.name);
                } else {
                    alert('Please select a PDF file');
                    e.target.value = '';
                }
            };

            const uploadFile = async () => {
                if (!uploadedFile) return null;

                setUploadProgress('Uploading...');
                
                try {
                    // Convert file to base64
                    const base64Data = await new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.onload = () => {
                            const base64 = reader.result.split(',')[1];
                            resolve(base64);
                        };
                        reader.onerror = reject;
                        reader.readAsDataURL(uploadedFile);
                    });

                    // DEBUG: Check data
                    console.log('=== UPLOAD DEBUG ===');
                    console.log('File name:', uploadedFile.name);
                    console.log('File type:', uploadedFile.type);
                    console.log('Base64 length:', base64Data ? base64Data.length : 'NULL');
                    console.log('Base64 preview:', base64Data ? base64Data.substring(0, 50) : 'NULL');

                    // Send to Google Apps Script
                    const formData = new URLSearchParams();
                    formData.append('action', 'uploadFile');
                    formData.append('fileData', base64Data);
                    formData.append('fileName', uploadedFile.name);
                    formData.append('mimeType', uploadedFile.type);

                    console.log('Sending to server...');

                    const res = await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        body: formData
                    });
                    
                    const data = await res.json();
                    console.log('Server response:', data);

                    if (data.success) {
                        setUploadProgress('Upload successful!');
                        return data.fileUrl;
                    } else {
                        setUploadProgress('Upload failed: ' + data.message);
                        return null;
                    }
                } catch (e) {
                    console.error('Upload error:', e);
                    setUploadProgress('Upload error: ' + e.message);
                    return null;
                }
            };


            const add = async () => {
                if (!newStudent.firstName || !newStudent.lastName || !newStudent.dateOfBirth || !newStudent.lrn || !newStudent.schoolYear) {
                    alert('Please fill all required fields (First Name, Last Name, Date of Birth, LRN, School Year)');
                    return;
                }

                setLoading(true);

                // Upload file if exists
                let fileUrl = null;
                if (uploadedFile) {
                    fileUrl = await uploadFile();
                    if (!fileUrl) {
                        setLoading(false);
                        return;
                    }
                }

                const studentData = { ...newStudent, sf10DocumentUrl: fileUrl || '' };

                try {
                    const res = await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        body: JSON.stringify({ action: 'add', data: studentData })
                    });
                    const data = await res.json();

                    if (data.success) {
                        alert('Student added successfully!');
                        loadData();
                        resetAdminSearch();
                        setUploadedFile(null);
                        setUploadProgress('');
                    } else {
                        alert('Error: ' + data.message);
                    }
                } catch (e) {
                    alert('Error adding student');
                }
                setLoading(false);
            };

            const updateStudent = async () => {
                if (!editStudent.firstName || !editStudent.lastName || !editStudent.dateOfBirth || !editStudent.lrn || !editStudent.schoolYear) {
                    alert('Please fill all required fields');
                    return;
                }

                setLoading(true);

                // Upload new file if exists
                let fileUrl = editStudent.sf10DocumentUrl;
                if (uploadedFile) {
                    const newFileUrl = await uploadFile();
                    if (newFileUrl) {
                        fileUrl = newFileUrl;
                    }
                }

                const studentData = { ...editStudent, sf10DocumentUrl: fileUrl };

                try {
                    const res = await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        body: JSON.stringify({ action: 'update', id: editStudent.id, data: studentData })
                    });
                    const data = await res.json();

                    if (data.success) {
                        alert('Student updated successfully!');
                        loadData();
                        resetAdminSearch();
                        setUploadedFile(null);
                        setUploadProgress('');
                    } else {
                        alert('Error: ' + data.message);
                    }
                } catch (e) {
                    alert('Error updating student');
                }
                setLoading(false);
            };

            const deleteStudent = async (id) => {
                setLoading(true);
                try {
                    const res = await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        body: JSON.stringify({ action: 'delete', id: id })
                    });
                    const data = await res.json();

                    if (data.success) {
                        alert('Student deleted successfully!');
                        loadData();
                        setShowDeleteConfirm(false);
                        setStudentToDelete(null);
                        if (adminView === 'search') {
                            setAdminSearchResults(adminSearchResults.filter(s => s.id !== id));
                        }
                    } else {
                        alert('Error: ' + data.message);
                    }
                } catch (e) {
                    alert('Error deleting student');
                }
                setLoading(false);
            };

            const sendPasswordReset = async () => {
                setLoading(true);
                try {
                    const res = await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        body: JSON.stringify({ action: 'sendPasswordReset' })
                    });
                    const data = await res.json();

                    if (data.success) {
                        alert('Password reset link has been sent to 108929@deped.gov.ph');
                        setShowForgotPassword(false);
                    } else {
                        alert('Error sending reset email: ' + data.message);
                    }
                } catch (e) {
                    alert('Error sending reset email');
                }
                setLoading(false);
            };

            const resetAdminSearch = () => {
                setAdminView('search');
                setAdminSearchFirst('');
                setAdminSearchMiddle('');
                setAdminSearchLast('');
                setAdminSearchLRN('');
                setAdminSearchResults([]);
                setEditStudent(null);
                setNewStudent({
        firstName: '', middleName: '', lastName: '', dateOfBirth: '', lrn: '',
        schoolYear: '2024-2025', gradeLastAttended: '', status: 'Graduated',
        sf10ReleasedTo: '', sf10ReleaseDate: '', sf10CopyReleased: '',
        sf10TrackingNumber: '', sf10ReceivedBy: '', sf10ReceivedByDate: '',
        sf10CopyReceived: '', sf10DateReceived: '', sf10ReceivedFrom: '',
        sf10EndorsedTo: '', sf10DateEndorsed: '', sf10DocumentUrl: ''
    });
                setUploadedFile(null);
                setUploadProgress('');
            };

            const resetPublicSearch = () => {
                setSearchFirst('');
                setSearchMiddle('');
                setSearchLast('');
                setSearchLRN('');
                setNoMiddleName(false);
                setResult(null);
            };

            const startAddNew = () => {
                setNewStudent({
        firstName: searchFirst.trim() || adminSearchFirst.trim(),
        middleName: searchMiddle.trim() || adminSearchMiddle.trim(),
        lastName: searchLast.trim() || adminSearchLast.trim(),
        dateOfBirth: '', lrn: '',
        schoolYear: '2024-2025', gradeLastAttended: '', status: 'Graduated',
        sf10ReleasedTo: '', sf10ReleaseDate: '', sf10CopyReleased: '',
        sf10TrackingNumber: '', sf10ReceivedBy: '', sf10ReceivedByDate: '',
        sf10CopyReceived: '', sf10DateReceived: '', sf10ReceivedFrom: '',
        sf10EndorsedTo: '', sf10DateEndorsed: '', sf10DocumentUrl: ''
    });
                setAdminView('add');
                setUploadedFile(null);
                setUploadProgress('');
            };

            const startUpdate = (student) => {
                setEditStudent(student);
                setAdminView('edit');
                setUploadedFile(null);
                setUploadProgress('');
            };

            const previewPDF = (url) => {
                setPdfPreview(url);
                setShowPdfModal(true);
            };

            const printPDF = (url) => {
                window.open(url, '_blank');
            };

            const confirmDelete = (student) => {
                setStudentToDelete(student);
                setShowDeleteConfirm(true);
            };

            // PUBLIC VIEW
            if (!isAdmin) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-green-50 p-4 pb-20">
                        {loading && <div className="fixed top-4 right-4 bg-blue-600 text-white px-4 py-2 rounded shadow z-50">Loading...</div>}
                        <div className="max-w-4xl mx-auto">
                            <div className="text-center mb-8">
                                <img src="logo.png" className="w-32 h-32 mx-auto mb-4" onError={(e) => e.target.style.display = 'none'} />
                                <h1 className="text-4xl font-bold text-blue-600 mb-2">ILAYANG YUNI ELEMENTARY SCHOOL</h1>
                                <h2 className="text-2xl font-semibold text-blue-600 mb-1">SF10 Information System</h2>
                                <p className="text-gray-600 font-semibold">Sa Ilayang Yuni, Lahat RESPONSABLE</p>
                            </div>
                            <div className="bg-white rounded-xl shadow-lg p-8 mb-6">
                                <h3 className="text-2xl font-semibold mb-6 text-center">Search SF10 Record</h3>

                                {/* Search Method Radio Buttons */}
                                <div className="mb-6">
                                    <label className="block mb-3 font-medium text-gray-700">Search Method:</label>
                                    <div className="flex gap-6">
                                        <label className="flex items-center cursor-pointer">
                                            <input
                                                type="radio"
                                                name="searchMethod"
                                                value="name"
                                                checked={searchMethod === 'name'}
                                                onChange={(e) => setSearchMethod(e.target.value)}
                                                className="w-4 h-4 mr-2"
                                            />
                                            <span className="text-gray-700">Search by Name</span>
                                        </label>
                                        <label className="flex items-center cursor-pointer">
                                            <input
                                                type="radio"
                                                name="searchMethod"
                                                value="lrn"
                                                checked={searchMethod === 'lrn'}
                                                onChange={(e) => setSearchMethod(e.target.value)}
                                                className="w-4 h-4 mr-2"
                                            />
                                            <span className="text-gray-700">Search by LRN</span>
                                        </label>
                                    </div>
                                </div>

                                {/* Conditional Fields */}
                                {searchMethod === 'name' ? (
                                    <>
                                        <input
                                            type="text"
                                            value={searchFirst}
                                            onChange={(e) => setSearchFirst(e.target.value)}
                                            placeholder="First Name"
                                            className="w-full p-3 border-2 rounded mb-3 focus:border-blue-500 outline-none"
                                            onKeyPress={(e) => e.key === 'Enter' && searchPublic()}
                                        />
                                        <input
                                            type="text"
                                            value={searchLast}
                                            onChange={(e) => setSearchLast(e.target.value)}
                                            placeholder="Last Name"
                                            className="w-full p-3 border-2 rounded mb-3 focus:border-blue-500 outline-none"
                                            onKeyPress={(e) => e.key === 'Enter' && searchPublic()}
                                        />
                                    </>
                                ) : (
                                    <input
                                        type="text"
                                        value={searchLRN}
                                        onChange={(e) => setSearchLRN(e.target.value)}
                                        placeholder="Enter LRN (12 digits)"
                                        className="w-full p-3 border-2 rounded mb-3 focus:border-blue-500 outline-none"
                                        maxLength="12"
                                        onKeyPress={(e) => e.key === 'Enter' && searchPublic()}
                                    />
                                )}

                                <button onClick={searchPublic} className="w-full bg-blue-600 text-white p-3 rounded font-semibold hover:bg-blue-700 transition">
                                    üîç Search
                                </button>
                            </div>

                            {/* MULTIPLE RECORDS FOUND */}
                            {result && result.multiple && (
                                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" onClick={() => setResult(null)}>
                                    <div className="bg-white rounded-xl max-w-lg w-full p-8" onClick={(e) => e.stopPropagation()}>
                                        <div className="text-center mb-6">
                                            <div className="inline-block bg-yellow-100 text-yellow-800 px-6 py-3 rounded-lg mb-4">
                                                <h3 className="text-2xl font-bold">‚ö† Multiple Records Found</h3>
                                            </div>
                                            <p className="text-gray-700 mb-2">We found <strong>{result.students.length} students</strong> with the name:</p>
                                            <p className="text-xl font-bold text-blue-600 mb-4">{searchFirst} {searchLast}</p>
                                            <p className="text-gray-600">Please enter your middle name to identify the correct record.</p>
                                        </div>

                                        <div className="space-y-4">
                                            <div>
                                                <label className="block mb-2 font-medium">Middle Name</label>
                                                <input
                                                    type="text"
                                                    value={searchMiddle}
                                                    onChange={(e) => {
                                                        setSearchMiddle(e.target.value);
                                                        if (e.target.value) setNoMiddleName(false);
                                                    }}
                                                    placeholder="Enter your middle name"
                                                    className="w-full p-3 border-2 rounded focus:border-blue-500 outline-none"
                                                    disabled={noMiddleName}
                                                    onKeyPress={(e) => e.key === 'Enter' && !noMiddleName && searchWithMiddleName()}
                                                />
                                            </div>

                                            <div className="flex items-center">
                                                <input
                                                    type="checkbox"
                                                    id="noMiddleName"
                                                    checked={noMiddleName}
                                                    onChange={(e) => {
                                                        setNoMiddleName(e.target.checked);
                                                        if (e.target.checked) setSearchMiddle('');
                                                    }}
                                                    className="w-4 h-4 mr-2"
                                                />
                                                <label htmlFor="noMiddleName" className="text-gray-700 cursor-pointer">
                                                    I don't have a middle name
                                                </label>
                                            </div>

                                            <button
                                                onClick={searchWithMiddleName}
                                                className="w-full bg-blue-600 text-white p-3 rounded font-semibold hover:bg-blue-700 transition">
                                                Search Again
                                            </button>
                                            <button
                                                onClick={() => setResult(null)}
                                                className="w-full bg-gray-300 text-gray-800 p-3 rounded font-semibold hover:bg-gray-400 transition">
                                                Cancel
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* SINGLE RECORD OR ERROR */}
                            {result && !result.multiple && (
                                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" onClick={resetPublicSearch}>
                                    <div className="bg-white rounded-xl max-w-5xl w-full max-h-[95vh] overflow-y-auto" onClick={(e) => e.stopPropagation()}>
                                        {result.error ? (
                                            <div className="p-8 text-center">
                                                <h3 className="text-2xl font-bold mb-4 text-red-600">No Record Found</h3>
                                                <p className="mb-4 text-gray-700">{result.error}</p>
                                                <button onClick={resetPublicSearch} className="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition">Close</button>
                                            </div>
                                        ) : (
                                            result.students.map((s, i) => (
                                                <div key={i} className="p-8">
                                                    <div className="text-center mb-6">
                                                        <img src="logo.png" className="w-24 h-24 mx-auto mb-3" onError={(e) => e.target.style.display = 'none'} />
                                                        <h2 className="text-2xl font-bold text-blue-600">ILAYANG YUNI ELEMENTARY SCHOOL</h2>
                                                        <p className="text-gray-600 font-semibold">Sa Ilayang Yuni, Lahat RESPONSABLE</p>
                                                        <div className="mt-3 inline-block bg-blue-600 text-white px-4 py-1 rounded-full">SF10 RECORD FOUND</div>
                                                    </div>

                                                    {/* Row 1: Names */}
                                                    <div className="grid grid-cols-3 gap-4 mb-4">
                                                        <div className="bg-blue-50 p-3 rounded">
                                                            <strong className="text-xs text-gray-600">First Name:</strong>
                                                            <div className="text-2xl font-bold mt-1">{s.firstName}</div>
                                                        </div>
                                                        <div className="bg-blue-50 p-3 rounded">
                                                            <strong className="text-xs text-gray-600">Middle Name:</strong>
                                                            <div className="text-2xl font-bold mt-1">{s.middleName || 'N/A'}</div>
                                                        </div>
                                                        <div className="bg-blue-50 p-3 rounded">
                                                            <strong className="text-xs text-gray-600">Last Name:</strong>
                                                            <div className="text-lg font-bold mt-1">{s.lastName}</div>
                                                        </div>
                                                    </div>

                                                    {/* Row 2: LRN and DOB */}
                                                    <div className="grid grid-cols-2 gap-4 mb-4">
                                                        <div className="bg-yellow-50 p-4 rounded">
                                                            <strong className="text-xs text-gray-600">LRN:</strong>
                                                            <div className="text-xl font-bold mt-1">{s.lrn}</div>
                                                        </div>
                                                        <div className="bg-purple-50 p-4 rounded">
                                                            <strong className="text-xs text-gray-600">Date of Birth:</strong>
                                                            <div className="text-xl font-bold mt-1">{new Date(s.dateOfBirth).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
                                                        </div>
                                                    </div>

                                                    {/* Row 3: School Year and Grade */}
                                                    <div className="grid grid-cols-2 gap-4 mb-4">
                                                        <div className="bg-blue-50 p-3 rounded">
                                                            <strong className="text-xs text-gray-600">School Year Last Attended:</strong>
                                                            <div className="text-lg font-bold mt-1">{s.schoolYear}</div>
                                                        </div>
                                                        <div className="bg-indigo-50 p-4 rounded">
                                                            <strong className="text-xs text-gray-600">Grade Last Attended:</strong>
                                                            <div className="text-lg font-bold mt-1">{s.gradeLastAttended || 'N/A'}</div>
                                                        </div>
                                                    </div>

                                                    {/* Status */}
                                                    <div className="bg-green-50 p-4 rounded mb-4">
                                                        <strong className="text-xs text-gray-600">Status:</strong>
                                                        <div className="mt-2">
                                                            <span className={`px-4 py-2 rounded ${statusColor(s.status)} font-bold text-lg`}>{s.status}</span>
                                                        </div>
                                                    </div>

                                                    {/* SF10 RECEIPT LOG */}
{(s.sf10DateReceived || s.sf10ReceivedFrom || s.sf10EndorsedTo || s.sf10DateEndorsed || s.sf10CopyReceived) && (
    <div className="bg-teal-50 p-3 rounded mb-3">
        <h4 className="font-bold mb-2 text-sm">SF10 RECEIPT LOG</h4>
        <div className="grid grid-cols-3 gap-3 text-xs">
            {s.sf10CopyReceived && (
                <div>
                    <strong className="text-gray-600">Copy Received:</strong>
                    <div className="font-semibold mt-1">{s.sf10CopyReceived}</div>
                </div>
            )}
            {s.sf10DateReceived && (
                <div>
                    <strong className="text-gray-600">Date Received:</strong>
                    <div className="font-semibold mt-1">{new Date(s.sf10DateReceived).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
                </div>
            )}
            {s.sf10ReceivedFrom && (
                <div>
                    <strong className="text-gray-600">Received From:</strong>
                    <div className="font-semibold mt-1">{s.sf10ReceivedFrom}</div>
                </div>
            )}
            {s.sf10EndorsedTo && (
                <div>
                    <strong className="text-gray-600">Endorsed To:</strong>
                    <div className="font-semibold mt-1">{s.sf10EndorsedTo}</div>
                </div>
            )}
            {s.sf10DateEndorsed && (
                <div>
                    <strong className="text-gray-600">Date Endorsed:</strong>
                    <div className="font-semibold mt-1">{new Date(s.sf10DateEndorsed).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
                </div>
            )}
        </div>
    </div>
)}

                                                    {/* SF10 RELEASE LOG */}
{(s.sf10ReleasedTo || s.sf10ReleaseDate || s.sf10CopyReleased || s.sf10TrackingNumber || s.sf10ReceivedBy || s.sf10ReceivedByDate) && (
    <div className="bg-orange-50 p-3 rounded mb-3">
        <h4 className="font-bold mb-2 text-sm">SF10 RELEASE LOG</h4>
        <div className="grid grid-cols-3 gap-3 text-xs">
            {s.sf10CopyReleased && (
                <div>
                    <strong className="text-gray-600">Copy Released:</strong>
                    <div className="font-semibold mt-1">{s.sf10CopyReleased}</div>
                </div>
            )}
            {s.sf10ReleaseDate && (
                <div>
                    <strong className="text-gray-600">Release Date:</strong>
                    <div className="font-semibold mt-1">{new Date(s.sf10ReleaseDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
                </div>
            )}
            {s.sf10ReleasedTo && (
                <div>
                    <strong className="text-gray-600">Released To:</strong>
                    <div className="font-semibold mt-1">{s.sf10ReleasedTo}</div>
                </div>
            )}
            {s.sf10TrackingNumber && (
                <div>
                    <strong className="text-gray-600">Tracking Number:</strong>
                    <div className="font-semibold mt-1">{s.sf10TrackingNumber}</div>
                </div>
            )}
            {s.sf10ReceivedBy && (
                <div>
                    <strong className="text-gray-600">Received By:</strong>
                    <div className="font-semibold mt-1">{s.sf10ReceivedBy}</div>
                </div>
            )}
            {s.sf10ReceivedByDate && (
                <div>
                    <strong className="text-gray-600">Received Date:</strong>
                    <div className="font-semibold mt-1">{new Date(s.sf10ReceivedByDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
                </div>
            )}
        </div>
    </div>
)}

                                                    {/* SF10 Availability Message */}
                                                    {(() => {
                                                        const status = getSF10Status(s);
                                                        return (
                                                            <div className={`${status.color} p-3 rounded mb-3`}>
                                                                <div className="flex items-start gap-2">
                                                                    <span className="text-2xl">{status.icon}</span>
                                                                    <div className="flex-1">
                                                                        <p className="font-bold text-sm mb-1">{status.message}</p>
                                                                        <p className="text-xs text-gray-700">{status.sub}</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        );
                                                    })()}

                                                    <button onClick={resetPublicSearch} className="w-full bg-blue-600 text-white p-3 rounded-lg font-semibold hover:bg-blue-700 transition">Close</button>
                                                </div>
                                            ))
                                        )}
                                    </div>
                                </div>
                            )}

                            <div className="text-center"><button onClick={() => setShowLogin(true)} className="text-gray-500 text-sm hover:text-gray-700">Administrator Access</button></div>
                            {/* Login Modal */}
                            {showLogin && (
                                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                                    <div className="bg-white rounded-lg p-6 max-w-md w-full">
                                        <h3 className="text-xl font-bold mb-4">Admin Login</h3>
                                        <input
                                            type="password"
                                            value={password}
                                            onChange={(e) => setPassword(e.target.value)}
                                            placeholder="Password"
                                            className="w-full p-2 border-2 rounded mb-2 focus:border-blue-500 outline-none"
                                            onKeyPress={(e) => e.key === 'Enter' && (password === 'IlayangYuni2025' ? (setIsAdmin(true), setShowLogin(false), setPassword('')) : setError('Wrong password'))}
                                        />
                                        {error && <p className="text-red-600 text-sm mb-2">{error}</p>}
                                        <div className="flex gap-2 mb-3">
                                            <button onClick={() => password === 'IlayangYuni2025' ? (setIsAdmin(true), setShowLogin(false), setPassword('')) : setError('Wrong password')} className="flex-1 bg-blue-600 text-white p-2 rounded hover:bg-blue-700 transition">Login</button>
                                            <button onClick={() => (setShowLogin(false), setPassword(''), setError(''))} className="flex-1 bg-gray-300 p-2 rounded hover:bg-gray-400 transition">Cancel</button>
                                        </div>
                                        <button onClick={() => { setShowLogin(false); setShowForgotPassword(true); }} className="text-blue-600 text-sm hover:underline">Forgot Password?</button>
                                    </div>
                                </div>
                            )}

                            {/* Forgot Password Modal */}
                            {showForgotPassword && (
                                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                                    <div className="bg-white rounded-lg p-6 max-w-md w-full">
                                        <h3 className="text-xl font-bold mb-4">Password Recovery</h3>
                                        <p className="mb-4 text-gray-700">A password reset link will be sent to:</p>
                                        <p className="mb-4 font-semibold text-blue-600">108929@deped.gov.ph</p>
                                        <div className="flex gap-2">
                                            <button onClick={sendPasswordReset} className="flex-1 bg-blue-600 text-white p-2 rounded hover:bg-blue-700 transition">Send Reset Link</button>
                                            <button onClick={() => { setShowForgotPassword(false); setShowLogin(true); }} className="flex-1 bg-gray-300 p-2 rounded hover:bg-gray-400 transition">Cancel</button>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* PDF Preview Modal */}
                            {showPdfModal && pdfPreview && (
                                <div className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50" onClick={() => setShowPdfModal(false)}>
                                    <div className="bg-white rounded-lg p-6 max-w-6xl w-full max-h-[90vh] overflow-auto" onClick={(e) => e.stopPropagation()}>
                                        <div className="flex justify-between items-center mb-4">
                                            <h3 className="text-xl font-bold">SF10 Document Preview</h3>
                                            <button onClick={() => setShowPdfModal(false)} className="text-gray-600 hover:text-gray-800 text-2xl">&times;</button>
                                        </div>
                                        <div className="pdf-preview-container">
                                            <iframe src={pdfPreview} className="w-full h-full" />
                                        </div>
                                        <div className="mt-4 flex gap-3">
                                            <button onClick={() => printPDF(pdfPreview)} className="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 transition">üñ®Ô∏è Print</button>
                                            <button onClick={() => setShowPdfModal(false)} className="bg-gray-300 px-6 py-2 rounded hover:bg-gray-400 transition">Close</button>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* Developer Credit */}
                        <div className="developer-credit">
                            Developed by: <strong>ALI VILLAVERDE TELADA</strong>
                        </div>
                    </div>
                );
            }

            // ADMIN VIEW
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-600 to-blue-800 p-4 pb-20">
                    {loading && <div className="fixed top-4 right-4 bg-white text-blue-600 px-4 py-2 rounded shadow z-50">Loading...</div>}

                    {/* Header */}
                    <div className="bg-white rounded-lg p-6 mb-6 flex justify-between items-center">
                        <div>
                            <h1 className="text-2xl font-bold">SF10 Information System - Admin</h1>
                            <p>Ilayang Yuni Elementary School</p>
                        </div>
                        <button onClick={() => setIsAdmin(false)} className="bg-white text-blue-600 px-4 py-2 rounded font-semibold hover:bg-gray-100 transition border-2 border-blue-600">Logout</button>
                    </div>

                    {/* Statistics */}
                    <div className="grid grid-cols-4 gap-4 mb-6">
                        <div className="bg-white rounded-lg p-4 text-center">
                            <div className="text-3xl font-bold text-blue-600">{students.length}</div>
                            <div className="text-gray-600">Total Records</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 text-center">
                            <div className="text-3xl font-bold text-green-600">{students.filter(s => s.status === 'Graduated').length}</div>
                            <div className="text-gray-600">Graduated</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 text-center">
                            <div className="text-3xl font-bold text-blue-600">{students.filter(s => s.status === 'Transferred Out').length}</div>
                            <div className="text-gray-600">Transferred Out</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 text-center">
                            <div className="text-3xl font-bold text-orange-600">{students.filter(s => s.status === 'Dropped').length}</div>
                            <div className="text-gray-600">Dropped</div>
                        </div>
                    </div>

                    {/* Navigation */}
                    <div className="mb-6 flex gap-2">
                        <button
                            onClick={resetAdminSearch}
                            className={`px-6 py-3 rounded font-semibold transition ${adminView === 'search' ? 'bg-blue-600 text-white' : 'bg-white text-blue-600 hover:bg-blue-50'}`}>
                            üîç Search Student
                        </button>
                        <button
                            onClick={() => setAdminView('list')}
                            className={`px-6 py-3 rounded font-semibold transition ${adminView === 'list' ? 'bg-blue-600 text-white' : 'bg-white text-blue-600 hover:bg-blue-50'}`}>
                            üìã View All Records
                        </button>
                        <button onClick={loadData} className="bg-green-600 text-white px-6 py-3 rounded font-semibold ml-auto hover:bg-green-700 transition">‚Üª Refresh Data</button>
                    </div>

                    {/* SEARCH VIEW */}
                    {adminView === 'search' && !adminSearchResults.length && (
                        <div className="bg-white rounded-lg p-8 shadow">
                            <h2 className="text-2xl font-bold mb-6 text-center">Search for Student Record</h2>
                            <div className="max-w-2xl mx-auto">
                                <div className="grid grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <label className="block mb-2 text-sm font-medium">First Name</label>
                                        <input
                                            type="text"
                                            value={adminSearchFirst}
                                            onChange={(e) => setAdminSearchFirst(e.target.value)}
                                            className="w-full p-3 border-2 rounded focus:border-blue-500 outline-none"
                                            placeholder="Enter first name"
                                        />
                                    </div>
                                    <div>
                                        <label className="block mb-2 text-sm font-medium">Middle Name</label>
                                        <input
                                            type="text"
                                            value={adminSearchMiddle}
                                            onChange={(e) => setAdminSearchMiddle(e.target.value)}
                                            className="w-full p-3 border-2 rounded focus:border-blue-500 outline-none"
                                            placeholder="Enter middle name"
                                        />
                                    </div>
                                    <div>
                                        <label className="block mb-2 text-sm font-medium">Last Name</label>
                                        <input
                                            type="text"
                                            value={adminSearchLast}
                                            onChange={(e) => setAdminSearchLast(e.target.value)}
                                            className="w-full p-3 border-2 rounded focus:border-blue-500 outline-none"
                                            placeholder="Enter last name"
                                        />
                                    </div>
                                    <div>
                                        <label className="block mb-2 text-sm font-medium">LRN</label>
                                        <input
                                            type="text"
                                            value={adminSearchLRN}
                                            onChange={(e) => setAdminSearchLRN(e.target.value)}
                                            className="w-full p-3 border-2 rounded focus:border-blue-500 outline-none"
                                            placeholder="Enter LRN"
                                            maxLength="12"
                                        />
                                    </div>
                                </div>
                                <button
                                    onClick={searchAdmin}
                                    className="w-full bg-blue-600 text-white p-4 rounded-lg font-semibold text-lg hover:bg-blue-700 transition">
                                    üîç Search Student
                                </button>
                            </div>
                        </div>
                    )}

                    {/* SEARCH RESULTS */}
                    {adminView === 'search' && adminSearchResults.length > 0 && (
                        <div className="bg-white rounded-lg p-6 shadow">
                            {adminSearchResults.map((student, index) => (
                                <div key={index} className="mb-6 p-6 border-2 rounded-lg">
                                    <h3 className="text-2xl font-bold mb-4">‚úì Record Found</h3>
                                    <div className="space-y-2 mb-4">
                                        <div><strong>Full Name:</strong> {student.firstName} {student.middleName} {student.lastName}</div>
                                        <div><strong>LRN:</strong> {student.lrn}</div>
                                        <div><strong>Date of Birth:</strong> {new Date(student.dateOfBirth).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
                                        <div><strong>School Year Last Attended:</strong> {student.schoolYear}</div>
                                        <div><strong>Grade Last Attended:</strong> {student.gradeLastAttended || 'N/A'}</div>
                                        <div><strong>Status:</strong> <span className={`px-3 py-1 rounded ${statusColor(student.status)}`}>{student.status}</span></div>
{student.sf10DocumentUrl && (
    <div className="flex items-center gap-2">
        <strong>SF10 Document:</strong>
        <button onClick={() => previewPDF(student.sf10DocumentUrl)} className="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition">
            üìÑ View
        </button>
        <button onClick={() => printPDF(student.sf10DocumentUrl)} className="bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition">
            üñ®Ô∏è Print
        </button>
    </div>
)}
                                    </div>
                                    <div className="flex gap-2">
                                        <button
                                            onClick={() => startUpdate(student)}
                                            className="flex-1 bg-blue-600 text-white p-3 rounded font-semibold hover:bg-blue-700 transition">
                                            üìù Update This Record
                                        </button>
                                        <button
                                            onClick={() => confirmDelete(student)}
                                            className="bg-red-600 text-white px-6 p-3 rounded font-semibold hover:bg-red-700 transition">
                                            üóëÔ∏è Delete
                                        </button>
                                    </div>
                                </div>
                            ))}

                            <button
                                onClick={resetAdminSearch}
                                className="w-full bg-gray-300 text-gray-800 p-3 rounded font-semibold hover:bg-gray-400 transition">
                                ‚Üê Back to Search
                            </button>
                        </div>
                    )}

                    {/* NO RESULTS */}
                    {adminView === 'search' && adminSearchResults.length === 0 && (adminSearchFirst || adminSearchMiddle || adminSearchLast || adminSearchLRN) && !loading && (
                        <div className="bg-white rounded-lg p-8 shadow text-center">
                            <h3 className="text-2xl font-bold mb-4">‚ö† No Record Found</h3>
                            <p className="text-gray-600 mb-6">No student found with the provided information.</p>
                            <div className="max-w-md mx-auto space-y-3">
                                <button
                                    onClick={startAddNew}
                                    className="w-full bg-green-600 text-white p-4 rounded-lg font-semibold text-lg hover:bg-green-700 transition">
                                    ‚ûï Add New Record
                                </button>
                                <button
                                    onClick={resetAdminSearch}
                                    className="w-full bg-gray-300 text-gray-800 p-3 rounded font-semibold hover:bg-gray-400 transition">
                                    ‚Üê Search Again
                                </button>
                            </div>
                        </div>
                    )}

                    {/* ADD NEW STUDENT */}
                    {adminView === 'add' && (
                        <div className="bg-white rounded-lg p-6 shadow">
                            <h3 className="text-2xl font-bold mb-6 text-center">‚ûï Add New Student Record</h3>
                            
                            {/* Row 1: Names */}
                            <div className="grid grid-cols-3 gap-3 mb-3">
                                <div><label className="block mb-1 text-sm font-medium">First Name *</label><input type="text" value={newStudent.firstName} onChange={(e) => setNewStudent({ ...newStudent, firstName: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" /></div>
                                <div><label className="block mb-1 text-sm font-medium">Middle Name (or N/A if none)</label><input type="text" value={newStudent.middleName} onChange={(e) => setNewStudent({ ...newStudent, middleName: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" placeholder="N/A" /></div>
                                <div><label className="block mb-1 text-sm font-medium">Last Name *</label><input type="text" value={newStudent.lastName} onChange={(e) => setNewStudent({ ...newStudent, lastName: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" /></div>
                            </div>

                            {/* Row 2: LRN and DOB */}
                            <div className="grid grid-cols-2 gap-4 mb-4">
                                <div><label className="block mb-1 text-sm font-medium">LRN * (or N/A if none)</label><input type="text" value={newStudent.lrn} onChange={(e) => setNewStudent({ ...newStudent, lrn: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" maxLength="12" placeholder="N/A" /></div>
                                <div><label className="block mb-1 text-sm font-medium">Date of Birth *</label><input type="date" value={newStudent.dateOfBirth} onChange={(e) => setNewStudent({ ...newStudent, dateOfBirth: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" /></div>
                            </div>

                            {/* Row 3: School Year and Grade */}
                            <div className="grid grid-cols-2 gap-4 mb-4">
                                <div><label className="block mb-1 text-sm font-medium">School Year Last Attended *</label><select value={newStudent.schoolYear} onChange={(e) => setNewStudent({ ...newStudent, schoolYear: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none"><option>2024-2025</option><option>2025-2026</option><option>2026-2027</option><option>2023-2024</option><option>2022-2023</option></select></div>
                                <div><label className="block mb-1 text-sm font-medium">Grade Last Attended</label><select value={newStudent.gradeLastAttended} onChange={(e) => setNewStudent({ ...newStudent, gradeLastAttended: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none"><option value="">Select Grade</option><option>Kinder</option><option>Grade 1</option><option>Grade 2</option><option>Grade 3</option><option>Grade 4</option><option>Grade 5</option><option>Grade 6</option></select></div>
                            </div>

                            {/* Status */}
                            <div className="mb-4">
                                <label className="block mb-1 text-sm font-medium">Status *</label>
                                <select value={newStudent.status} onChange={(e) => setNewStudent({ ...newStudent, status: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none"><option>Graduated</option><option>Transferred Out</option><option>Dropped</option><option>Failed</option><option>Stopped</option></select>
                            </div>

                            {/* SF10 RELEASE LOG (Optional) */}
<div className="bg-orange-50 p-4 rounded mb-4">
    <h4 className="font-semibold mb-2">SF10 RELEASE LOG (Optional)</h4>
    <div className="grid grid-cols-3 gap-3 mb-3">
        <div>
            <label className="block mb-1 text-sm">SF10 Copy Released</label>
            <select value={newStudent.sf10CopyReleased} onChange={(e) => setNewStudent({ ...newStudent, sf10CopyReleased: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none">
                <option value="">Select Type</option>
                <option value="Original">Original</option>
                <option value="Authenticated">Authenticated</option>
            </select>
        </div>
        <div><label className="block mb-1 text-sm">Release Date</label><input type="date" value={newStudent.sf10ReleaseDate} onChange={(e) => setNewStudent({ ...newStudent, sf10ReleaseDate: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" /></div>
        <div><label className="block mb-1 text-sm">Released To</label><input type="text" value={newStudent.sf10ReleasedTo} onChange={(e) => setNewStudent({ ...newStudent, sf10ReleasedTo: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" placeholder="School/Person" /></div>
    </div>
    <div className="grid grid-cols-3 gap-3">
        <div><label className="block mb-1 text-sm">Tracking Number</label><input type="text" value={newStudent.sf10TrackingNumber} onChange={(e) => setNewStudent({ ...newStudent, sf10TrackingNumber: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" placeholder="e.g. TRK-2025-001" /></div>
        <div><label className="block mb-1 text-sm">Received By</label><input type="text" value={newStudent.sf10ReceivedBy} onChange={(e) => setNewStudent({ ...newStudent, sf10ReceivedBy: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" placeholder="Name of recipient" /></div>
        <div><label className="block mb-1 text-sm">Received Date</label><input type="date" value={newStudent.sf10ReceivedByDate} onChange={(e) => setNewStudent({ ...newStudent, sf10ReceivedByDate: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" /></div>
    </div>
</div>

                            {/* SF10 RECEIPT LOG (Optional) */}
<div className="bg-teal-50 p-4 rounded mb-4">
    <h4 className="font-semibold mb-2">SF10 RECEIPT LOG (Optional)</h4>
    <div className="grid grid-cols-3 gap-3 mb-3">
        <div>
            <label className="block mb-1 text-sm">SF10 Copy Received</label>
            <select value={newStudent.sf10CopyReceived} onChange={(e) => setNewStudent({ ...newStudent, sf10CopyReceived: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none">
                <option value="">Select Type</option>
                <option value="Original">Original</option>
                <option value="Authenticated">Authenticated</option>
            </select>
        </div>
        <div><label className="block mb-1 text-sm">Date Received</label><input type="date" value={newStudent.sf10DateReceived} onChange={(e) => setNewStudent({ ...newStudent, sf10DateReceived: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" /></div>
        <div><label className="block mb-1 text-sm">Received From</label><input type="text" value={newStudent.sf10ReceivedFrom} onChange={(e) => setNewStudent({ ...newStudent, sf10ReceivedFrom: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" placeholder="School/Person" /></div>
    </div>
    <div className="grid grid-cols-2 gap-3">
        <div><label className="block mb-1 text-sm">Endorsed To</label><input type="text" value={newStudent.sf10EndorsedTo} onChange={(e) => setNewStudent({ ...newStudent, sf10EndorsedTo: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" placeholder="Name" /></div>
        <div><label className="block mb-1 text-sm">Date Endorsed</label><input type="date" value={newStudent.sf10DateEndorsed} onChange={(e) => setNewStudent({ ...newStudent, sf10DateEndorsed: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" /></div>
    </div>
</div>

                            {/* SF10 Document Upload */}
                            <div className="bg-indigo-50 p-4 rounded mb-4">
                                <h4 className="font-semibold mb-2">SF10 Document Upload (Optional)</h4>
                                <input
                                    type="file"
                                    accept="application/pdf"
                                    onChange={handleFileSelect}
                                    className="w-full p-2 border rounded focus:border-blue-500 outline-none"
                                />
                                {uploadProgress && <p className="text-sm mt-2 text-gray-600">{uploadProgress}</p>}
                            </div>

                            <div className="flex gap-2">
                                <button onClick={add} className="flex-1 bg-green-600 text-white px-6 py-3 rounded font-semibold hover:bg-green-700 transition">‚úì Save New Record</button>
                                <button onClick={resetAdminSearch} className="flex-1 bg-gray-300 px-6 py-3 rounded font-semibold hover:bg-gray-400 transition">Cancel</button>
                            </div>
                        </div>
                    )}

                    {/* EDIT STUDENT */}
                    {adminView === 'edit' && editStudent && (
                        <div className="bg-white rounded-lg p-6 shadow">
                            <h3 className="text-2xl font-bold mb-6 text-center">üìù Update Student Record</h3>
                            <div className="bg-blue-50 p-3 rounded mb-4">
                                <h4 className="font-semibold mb-2">Student Information</h4>
                                <p><strong>Name:</strong> {editStudent.firstName} {editStudent.middleName} {editStudent.lastName}</p>
                                <p><strong>LRN:</strong> {editStudent.lrn}</p>
                            </div>

                            {/* Row 1: Names */}
                            <div className="grid grid-cols-3 gap-3 mb-3">
                                <div><label className="block mb-1 text-sm font-medium">First Name *</label><input type="text" value={editStudent.firstName} onChange={(e) => setEditStudent({ ...editStudent, firstName: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" /></div>
                                <div><label className="block mb-1 text-sm font-medium">Middle Name (or N/A if none)</label><input type="text" value={editStudent.middleName || ''} onChange={(e) => setEditStudent({ ...editStudent, middleName: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" placeholder="N/A" /></div>
                                <div><label className="block mb-1 text-sm font-medium">Last Name *</label><input type="text" value={editStudent.lastName} onChange={(e) => setEditStudent({ ...editStudent, lastName: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" /></div>
                            </div>

                            {/* Row 2: LRN and DOB */}
                            <div className="grid grid-cols-2 gap-4 mb-4">
                                <div><label className="block mb-1 text-sm font-medium">LRN * (or N/A if none)</label><input type="text" value={editStudent.lrn} onChange={(e) => setEditStudent({ ...editStudent, lrn: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" maxLength="12" placeholder="N/A" /></div>
                                <div><label className="block mb-1 text-sm font-medium">Date of Birth *</label><input type="date" value={editStudent.dateOfBirth} onChange={(e) => setEditStudent({ ...editStudent, dateOfBirth: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none" /></div>
                            </div>

                            {/* Row 3: School Year and Grade */}
                            <div className="grid grid-cols-2 gap-4 mb-4">
                                <div><label className="block mb-1 text-sm font-medium">School Year Last Attended *</label><select value={editStudent.schoolYear} onChange={(e) => setEditStudent({ ...editStudent, schoolYear: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none"><option>2024-2025</option><option>2025-2026</option><option>2026-2027</option><option>2023-2024</option><option>2022-2023</option></select></div>
                                <div><label className="block mb-1 text-sm font-medium">Grade Last Attended</label><select value={editStudent.gradeLastAttended || ''} onChange={(e) => setEditStudent({ ...editStudent, gradeLastAttended: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none"><option value="">Select Grade</option><option>Kinder</option><option>Grade 1</option><option>Grade 2</option><option>Grade 3</option><option>Grade 4</option><option>Grade 5</option><option>Grade 6</option></select></div>
                            </div>

                            {/* Status */}
                            <div className="mb-4">
                                <label className="block mb-1 text-sm font-medium">Status *</label>
                                <select value={editStudent.status} onChange={(e) => setEditStudent({ ...editStudent, status: e.target.value })} className="w-full p-2 border-2 rounded focus:border-blue-500 outline-none"><option>Graduated</option><option>Transferred Out</option><option>Dropped</option><option>Failed</option><option>Stopped</option></select>
                            </div>

                            {/* SF10 RELEASE LOG (Optional) */}
<div className="bg-orange-50 p-4 rounded mb-4">
    <h4 className="font-semibold mb-2">SF10 RELEASE LOG (Optional)</h4>
    <div className="grid grid-cols-3 gap-3 mb-3">
        <div>
            <label className="block mb-1 text-sm">SF10 Copy Released</label>
            <select value={editStudent.sf10CopyReleased || ''} onChange={(e) => setEditStudent({ ...editStudent, sf10CopyReleased: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none">
                <option value="">Select Type</option>
                <option value="Original">Original</option>
                <option value="Authenticated">Authenticated</option>
            </select>
        </div>
        <div><label className="block mb-1 text-sm">Release Date</label><input type="date" value={editStudent.sf10ReleaseDate || ''} onChange={(e) => setEditStudent({ ...editStudent, sf10ReleaseDate: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" /></div>
        <div><label className="block mb-1 text-sm">Released To</label><input type="text" value={editStudent.sf10ReleasedTo || ''} onChange={(e) => setEditStudent({ ...editStudent, sf10ReleasedTo: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" placeholder="School/Person" /></div>
    </div>
    <div className="grid grid-cols-3 gap-3">
        <div><label className="block mb-1 text-sm">Tracking Number</label><input type="text" value={editStudent.sf10TrackingNumber || ''} onChange={(e) => setEditStudent({ ...editStudent, sf10TrackingNumber: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" placeholder="e.g. TRK-2025-001" /></div>
        <div><label className="block mb-1 text-sm">Received By</label><input type="text" value={editStudent.sf10ReceivedBy || ''} onChange={(e) => setEditStudent({ ...editStudent, sf10ReceivedBy: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" placeholder="Name of recipient" /></div>
        <div><label className="block mb-1 text-sm">Received Date</label><input type="date" value={editStudent.sf10ReceivedByDate || ''} onChange={(e) => setEditStudent({ ...editStudent, sf10ReceivedByDate: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" /></div>
    </div>
</div>

                            {/* SF10 RECEIPT LOG (Optional) */}
<div className="bg-teal-50 p-4 rounded mb-4">
    <h4 className="font-semibold mb-2">SF10 RECEIPT LOG (Optional)</h4>
    <div className="grid grid-cols-3 gap-3 mb-3">
        <div>
            <label className="block mb-1 text-sm">SF10 Copy Received</label>
            <select value={editStudent.sf10CopyReceived || ''} onChange={(e) => setEditStudent({ ...editStudent, sf10CopyReceived: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none">
                <option value="">Select Type</option>
                <option value="Original">Original</option>
                <option value="Authenticated">Authenticated</option>
            </select>
        </div>
        <div><label className="block mb-1 text-sm">Date Received</label><input type="date" value={editStudent.sf10DateReceived || ''} onChange={(e) => setEditStudent({ ...editStudent, sf10DateReceived: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" /></div>
        <div><label className="block mb-1 text-sm">Received From</label><input type="text" value={editStudent.sf10ReceivedFrom || ''} onChange={(e) => setEditStudent({ ...editStudent, sf10ReceivedFrom: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" placeholder="School/Person" /></div>
    </div>
    <div className="grid grid-cols-2 gap-3">
        <div><label className="block mb-1 text-sm">Endorsed To</label><input type="text" value={editStudent.sf10EndorsedTo || ''} onChange={(e) => setEditStudent({ ...editStudent, sf10EndorsedTo: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" placeholder="Name" /></div>
        <div><label className="block mb-1 text-sm">Date Endorsed</label><input type="date" value={editStudent.sf10DateEndorsed || ''} onChange={(e) => setEditStudent({ ...editStudent, sf10DateEndorsed: e.target.value })} className="w-full p-2 border rounded focus:border-blue-500 outline-none" /></div>
    </div>
</div>

                            {/* SF10 Document Management */}
<div className="bg-indigo-50 p-4 rounded mb-4">
    <h4 className="font-semibold mb-3">SF10 Document Management</h4>
    {editStudent.sf10DocumentUrl && (
        <div className="mb-3 p-3 bg-white rounded border">
            <p className="text-sm mb-2"><strong>Current Document:</strong> Document uploaded</p>
            <button onClick={() => setEditStudent({ ...editStudent, sf10DocumentUrl: '' })} className="bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition">üóëÔ∏è Remove Document</button>
        </div>
    )}
                                <label className="block mb-1 text-sm font-medium">Upload New SF10 Document (PDF)</label>
                                <input
                                    type="file"
                                    accept="application/pdf"
                                    onChange={handleFileSelect}
                                    className="w-full p-2 border rounded focus:border-blue-500 outline-none"
                                />
                                {uploadProgress && <p className="text-sm mt-2 text-gray-600">{uploadProgress}</p>}
                            </div>

                            <div className="flex gap-2">
                                <button onClick={updateStudent} className="flex-1 bg-blue-600 text-white px-6 py-3 rounded font-semibold hover:bg-blue-700 transition">‚úì Update Record</button>
                                <button onClick={resetAdminSearch} className="flex-1 bg-gray-300 px-6 py-3 rounded font-semibold hover:bg-gray-400 transition">Cancel</button>
                            </div>
                        </div>
                    )}

                    {/* LIST VIEW */}
                    {adminView === 'list' && (
                        <div className="bg-white rounded-lg p-6 shadow">
                            <h3 className="text-xl font-bold mb-4">All Student Records ({students.length} total)</h3>
                            <div className="overflow-x-auto">
                                <table className="w-full">
                                    <thead className="bg-blue-50">
                                        <tr>
                                            <th className="p-3 text-left text-xs font-semibold">Name</th>
                                            <th className="p-3 text-left text-xs font-semibold">LRN</th>
                                            <th className="p-3 text-left text-xs font-semibold">School Year Last Attended</th>
                                            <th className="p-3 text-left text-xs font-semibold">Grade</th>
                                            <th className="p-3 text-left text-xs font-semibold">Status</th>
                                            <th className="p-3 text-left text-xs font-semibold">SF10 Document</th>
                                            <th className="p-3 text-left text-xs font-semibold">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {students.map((s, i) => (
                                            <tr key={i} className="border-b hover:bg-gray-50">
                                                <td className="p-3 text-sm">{s.firstName} {s.middleName} {s.lastName}</td>
                                                <td className="p-3 text-sm">{s.lrn}</td>
                                                <td className="p-3 text-sm">{s.schoolYear}</td>
                                                <td className="p-3 text-sm">{s.gradeLastAttended || 'N/A'}</td>
                                                <td className="p-3 text-sm"><span className={`px-2 py-1 rounded text-xs ${statusColor(s.status)}`}>{s.status}</span></td>
                                                <td className="p-3 text-sm">
                                                    {s.sf10DocumentUrl ? (
                                                        <button onClick={() => previewPDF(s.sf10DocumentUrl)} className="text-blue-600 hover:underline text-xs">View</button>
                                                    ) : (
                                                        <span className="text-gray-400 text-xs">No document</span>
                                                    )}
                                                </td>
                                                <td className="p-3 text-sm">
                                                    <div className="flex gap-1">
                                                        <button onClick={() => startUpdate(s)} className="bg-blue-600 text-white px-2 py-1 rounded text-xs hover:bg-blue-700 transition">Edit</button>
                                                        <button onClick={() => confirmDelete(s)} className="bg-red-600 text-white px-2 py-1 rounded text-xs hover:bg-red-700 transition">Delete</button>
                                                    </div>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    )}

                    {/* Delete Confirmation Modal */}
                    {showDeleteConfirm && studentToDelete && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className="bg-white rounded-lg p-6 max-w-md w-full">
                                <h3 className="text-xl font-bold mb-4 text-red-600">‚ö†Ô∏è Confirm Delete</h3>
                                <p className="mb-2">Are you sure you want to delete this student record?</p>
                                <p className="mb-4 font-semibold">{studentToDelete.firstName} {studentToDelete.middleName} {studentToDelete.lastName}</p>
                                <p className="mb-6 text-xs text-gray-600">This action cannot be undone!</p>
                                <div className="flex gap-2">
                                    <button onClick={() => deleteStudent(studentToDelete.id)} className="flex-1 bg-red-600 text-white p-2 rounded hover:bg-red-700 transition">Yes, Delete</button>
                                    <button onClick={() => { setShowDeleteConfirm(false); setStudentToDelete(null); }} className="flex-1 bg-gray-300 p-2 rounded hover:bg-gray-400 transition">Cancel</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* PDF Preview Modal */}
                    {showPdfModal && pdfPreview && (
                        <div className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50" onClick={() => setShowPdfModal(false)}>
                            <div className="bg-white rounded-lg p-6 max-w-6xl w-full max-h-[90vh] overflow-auto" onClick={(e) => e.stopPropagation()}>
                                <div className="flex justify-between items-center mb-4">
                                    <h3 className="text-xl font-bold">SF10 Document Preview</h3>
                                    <button onClick={() => setShowPdfModal(false)} className="text-gray-600 hover:text-gray-800 text-2xl">&times;</button>
                                </div>
                                <div className="pdf-preview-container">
                                    <iframe src={pdfPreview} className="w-full h-full" />
                                </div>
                                <div className="mt-4 flex gap-3">
                                    <button onClick={() => printPDF(pdfPreview)} className="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 transition">üñ®Ô∏è Print</button>
                                    <button onClick={() => setShowPdfModal(false)} className="bg-gray-300 px-6 py-2 rounded hover:bg-gray-400 transition">Close</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Developer Credit */}
                    <div className="developer-credit">
                        Developed by: <strong>ALI VILLAVERDE TELADA</strong>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>


